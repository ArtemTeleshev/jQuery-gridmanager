<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Gridmanager Development</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">  

    <!-- Bootstrap CSS -->
    <link href="//netdna.bootstrapcdn.com/bootswatch/3.1.1/cerulean/bootstrap.min.css" rel="stylesheet">   

    <!-- Grid Manager CSS -->
    <link href="gridmanager.css" rel="stylesheet"> 

   
    <link href="demo.css" rel="stylesheet"> 

     <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
     <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <!-- jQuery UI -->
     <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <!-- Bootstrap JS -->
     <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
 
 <style>
  .red {border:1px solid red; padding:5px;}
  .blue {border:1px solid blue; padding:5px;}
  .row-tools {border:1px solid #999; padding:5px; margin:3px;}
  .col-tools {border:1px solid #666; padding:5px;margin:3px; } 
  .nested {border:1px solid green;}
  .editable {background-color: yellow; min-height: 25px; padding:5px;}
 </style>

  
  </head>
<body>  
  
   <div class="container"> 
    <div id="mycanvas" class="clearfix">
              <!-- without editing markup -->
        <div class="row">
            <!-- parent col -->
                <div class="col-md-6">
               
                        <p>Content which is before the nested row</p>
                        <p>Content which is before the nested row</p>
                        <p>Content which is before the nested row</p>
                        <p>Content which is before the nested row</p>
                        <p>Content which is before the nested row</p>
               
                        <!-- nested row -->
                   <div class="row">
                         
                                <!-- nested col -->
                                <div class="col-md-6">
                                   <p>Nested Level 1</p>
                                   <p>Nested Level 1</p>
                                   <p>Nested Level 1</p>

        <!-- SUB nested row -->
                   <div class="row">
                         
                                <!-- SUB nested col -->
                                <div class="col-md-6">
                                 
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                                 </div>
                               
                                <!-- SUB nested col -->
                                <div class="col-md-6">
                                  
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                                   <p>Nested Level 2</p>
                               </div>
                     </div>
                 



                                </div>
                               
                                <!-- nested col -->
                                <div class="col-md-6">
                                  <p>Stuff</p><p>Stuff</p><p>Stuff</p><p>Stuff</p><p>Stuff</p><p>Stuff</p>
                                </div>
                  </div>
                 
                   <p>Content which is afterthe nested row</p>
                </div>
               
                <!-- normal col-->
                <div class="col-md-6">
                        <p>Other column content</p>
                        <p>Other column content</p>
                        <p>Other column content</p>
                        <p>Other column content</p>
                        <p>Other column content</p>
                        <p>Other column content</p>
                        <p>Other column content</p>
                </div>
        </div>
       </div>
    </div>
<!--================== JS ================--> 
 <script>

$(document).ready(function(){  
 
  identifyRows();
  identifyCols();
  indentifyContent();
  insertRowTools(); 
  insertColTools();

  function identifyRows(){ 
    $("#mycanvas").find("div.row").addClass("red");
  };

  function identifyCols(){ 
    $("#mycanvas").find("div[class*=col-]").addClass("blue");
  };

  function insertRowTools(){
    $("#mycanvas").find("div.row")
      .prepend("<div class='row-tools clearfix'>Row Tools Prepend</div>")
      .append("<div class='row-tools clearfix'>Row Tools Append</div>");
  };
 
  function insertColTools(){
    $("#mycanvas").find("div[class*=col-]")
      .prepend("<div class='col-tools clearfix'>Col Tools</div>")
      .append("<div class='col-tools clearfix'>Col Tools Append</div>");
  };

  function indentifyContent(){ 
    // Get all columns
    var cols=$("#mycanvas").find("div[class*=col-]");
    
    // For each column, 
    $.each(cols, function(i, column){ 
      //work out whether it's got a nested div.row
      if($(column).children().hasClass("row")){ 
        console.log("Nested row recognised");
            // If has nested, loop over column children and assign editable regions before and after
            $.each($(column).children(), function(i, val){ 
                if($(val).hasClass("row")){
                    var prev=$(val).prevAll(); 
                    var after=$(val).nextAll(); 
                    $(val).before($("<div />").addClass("editable").html(prev)); 
                    $(val).after($("<div />").addClass("editable").html(after)); 
                } 
            }); 
      } else {
        // Column has no nested rows, assign a single default editable region                
        console.log("Non-nested column");
        console.log($(column));
        $(column).wrapInner($("<div />").addClass("editable"));
      }
    
    });   
  };
 

});
 </script>
</body>
</html>
  